image:
  file: .gitpod.dockerfile

ports:
  - port: 8080
    onOpen: open-preview
  - port: 3306
    onOpen: ignore
  - port: 8025
    onOpen: ignore
  - port: 1025
    onOpen: ignore
  - port: 9000
    onOpen: ignore

tasks:
  - name: set up wordpress file structure
    init: |
      bash ./gitpod.setup.sh init 
    command: >
      gp await-port 3306
      &&
      bash ./gitpod.setup.sh command
      &&
      gp sync-done wp-install

  - name: wp server
    command: |
      sync-await wp-install
      wp server --host=0.0.0.0

  - name: mailhog # start MailHog (SMTP testing tool) 
    command: mailhog -api-bind-addr 127.0.0.1:8025 -ui-bind-addr 127.0.0.1:8025 -smtp-bind-addr 127.0.0.1:1025
